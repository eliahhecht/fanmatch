@model FanMatch.ViewModels.MatchResultViewModel

@{
    ViewBag.Title = "Match Results";
}

<h1>@ViewBag.Title</h1>

<h3>Locked</h3>

<script>
    $(function () {
        $('table .btn').on('click', function (e) {
            e.preventDefault();
            var tr = $(this).closest("tr");
            $("#reader").val(tr.data('reader-id'));
            $("#writer").val(tr.data('writer-id'));
            var action;
            if ($(this).is('.lock')) {
                action = "@FanMatch.Controllers.MatchAction.Lock";
            }
            else if ($(this).is('.ban')) {
                action = "@FanMatch.Controllers.MatchAction.Ban";
            }
            else {
                action = "@FanMatch.Controllers.MatchAction.Clear";
            }
            $("#matchAction").val(action);
            $("#ChangeMatchStatus").submit();
        });
    });
</script>

<style type="text/css">
    .match-table th {
        width: 20%;
    }
</style>

<form method="post" id="ChangeMatchStatus" action="@Url.Action("ChangeMatchStatus")">
    <input type="hidden" name="reader" id="reader" />
    <input type="hidden" name="writer" id="writer"/>
    <input type="hidden" name="action" id="matchAction"/>
</form>

<table class="table table-bordered table-striped match-table">
    <tr>
        <th>Reader</th>
        <th>Writer</th>
        <th>Fandom</th>
        <th>Unlock</th>
        <th>Ban</th>
    </tr>
    @foreach (var match in Model.Locked)
    {
       <tr data-reader-id="@match.ReaderId" data-writer-id="@match.WriterId">
            <td>@match.ReaderName</td>
            <td>@match.WriterName</td>
            <td>@match.FandomName</td>
            <td><a class="btn unlock" href="#"><i class="icon-lock"></i></a></td>
            <td><a class="btn btn-danger ban" href="#"><i class="icon-ban-circle"></i></a></td>
        </tr>
    }
</table>

<h3>Matched</h3>

<table class="table table-bordered table-striped match-table">
    <tr>
        <th>Reader</th>
        <th>Writer</th>
        <th>Fandom</th>
        <th>Lock</th>
        <th>Ban</th>
    </tr>
    @foreach (var match in Model.Matches)
    {
       <tr data-reader-id="@match.ReaderId" data-writer-id="@match.WriterId">
            <td>@match.ReaderName</td>
            <td>@match.WriterName</td>
            <td>@match.FandomName</td>
            <td><a class="btn btn-success lock" href="#"><i class="icon-lock"></i></a></td>
            <td><a class="btn btn-danger ban" href="#"><i class="icon-ban-circle"></i></a></td>
        </tr>
    }
</table>

@if (Model.UnmatchedPeople.Any())
{

    <h3>Unmatched</h3>
    
    @Html.Partial("_PersonTable", Model.UnmatchedPeople) 
    
    
}


<h3>Banned</h3>

<table class="table table-bordered table-striped match-table">
    <tr>
        <th>Reader</th>
        <th>Writer</th>
        <th>Fandom</th>
        <th>Lock</th>
        <th>Unban</th>
    </tr>
    @foreach (var match in Model.Banned)
    {
       <tr data-reader-id="@match.ReaderId" data-writer-id="@match.WriterId">
            <td>@match.ReaderName</td>
            <td>@match.WriterName</td>
            <td>@match.FandomName</td>
            <td><a class="btn btn-success lock" href="#"><i class="icon-lock"></i></a></td>
            <td><a class="btn unban" href="#"><i class="icon-ban-circle"></i></a></td>
        </tr>
    }
</table>

